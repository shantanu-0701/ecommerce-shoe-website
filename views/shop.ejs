<%- include('./partials/head2') %>
<% if(success && success.length > 0) { %>
  <div class="flex justify-center mt-4">
    <div class="bg-green-500 text-white text-center py-3 px-6 rounded-lg shadow-lg animate-bounce">
      <%= success %>
    </div>
  </div>
<% } %>

<div class="w-full min-h-screen flex flex-col lg:flex-row px-6 lg:px-20 py-10 bg-gradient-to-br from-green-50 to-white text-gray-800">
    
    <aside class="w-full lg:w-1/4 mb-10 lg:mb-0 pr-6">
        <div class="space-y-10 sticky top-20 bg-white rounded-xl shadow-md p-6">
            
            <div>
                <h3 class="font-semibold text-lg mb-3 text-green-600 border-b border-green-200 pb-2">Sort By</h3>
                <form action="/shop" method="GET">
                    <select name="sortby" onchange="this.form.submit()" class="w-full border rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-green-400">
                        <option value="popular" <%= locals.sortby === 'popular' ? 'selected' : '' %>>Popular</option>
                        <option value="newest" <%= locals.sortby === 'newest' ? 'selected' : '' %>>Newest</option>
                        <option value="price-asc" <%= locals.sortby === 'price-asc' ? 'selected' : '' %>>Price: Low to High</option>
                        <option value="price-desc" <%= locals.sortby === 'price-desc' ? 'selected' : '' %>>Price: High to Low</option>
                    </select>
                </form>
            </div>

            <div>
                <h3 class="font-semibold text-lg mb-3 text-green-600 border-b border-green-200 pb-2">Categories</h3>
                <ul class="space-y-2 text-sm">
                    <li><a href="/shop" class="block px-2 py-1 rounded hover:bg-green-100 hover:text-green-700">All Products</a></li>
                    <li><a href="/shop?filter=new" class="block px-2 py-1 rounded hover:bg-green-100 hover:text-green-700">New Collection</a></li>
                    <li><a href="/shop?filter=discounted" class="block px-2 py-1 rounded hover:bg-green-100 hover:text-green-700">Discounted Products</a></li>
                </ul>
            </div>

            <div>
                <h3 class="font-semibold text-lg mb-3 text-green-600 border-b border-green-200 pb-2">Filter By</h3>
                <ul class="space-y-2 text-sm">
                    <li><a href="/shop?filter=available" class="block px-2 py-1 rounded hover:bg-green-100 hover:text-green-700">Availability</a></li>
                </ul>
            </div>
        </div>
    </aside>

    <section class="w-full lg:w-3/4">
        <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-8">
            <% if(products.length > 0) { %>
                <% products.forEach(function(product){ %>
                    <div class="bg-white shadow-lg rounded-2xl overflow-hidden transition-transform transform hover:-translate-y-2 hover:shadow-2xl duration-300">
                        <div class="h-56 flex items-center justify-center bg-[<%= product.bgcolor %>]">
                            
                            <img class="h-[13rem] object-contain drop-shadow-md" src="<%= product.image %>" alt="<%= product.name %>">
                            
                        </div>
                        <div class="p-5 bg-[<%= product.panelcolor %>] text-[<%= product.textcolor %>] flex justify-between items-center">
                            <div>
                                <h3 class="font-bold text-lg text-green-700"><%= product.name %></h3>
                                <p class="text-md font-medium text-green-600">â‚¹ <%= product.price %></p>
                            </div>
                            <a href="/addtocart/<%= product._id%>" class="w-10 h-10 flex items-center justify-center rounded-full bg-green-500 text-white hover:bg-green-600 transition-colors shadow-md">
                                <i class="ri-add-line text-xl"></i>
                            </a>
                        </div>
                    </div>
                <% }) %>
            <% } else { %>
                <div class="col-span-full text-center py-10">
                    <p class="text-gray-500 text-lg">No products found matching your criteria.</p>
                </div>
            <% } %>
        </div>
    </section>
</div>

<%- include('./partials/footer') %>